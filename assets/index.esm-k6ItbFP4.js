import{I as C,X as _,b as L,J as h,T as I,Y as b,N as v,Z as T,r as E,F as k,w as q}from"./index-Dae4z8GE.js";var s={library:"https://accounts.google.com/gsi/client",defaultButtonConfig:{theme:"outline",size:"large"},scopes:"email profile openid",ssrError:"vue3-google-login cannot be executed on the server side. See here for more info https://devbaji.github.io/vue3-google-login/#no-ssr-support"};const a=k({clientId:null,popupType:"CODE",prompt:!1,autoLogin:!1,idConfiguration:null,buttonConfig:s.defaultButtonConfig,callback:()=>{},error:null}),d=k({apiLoaded:!1,apiLoadIntitited:!1}),N=t=>{try{const o=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),e=decodeURIComponent(atob(o).split("").map((function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(e)}catch{throw"JWT provided is invalid"}},y=()=>new Promise(((t,o)=>{if(typeof window<"u"){if(!d.apiLoadIntitited){const e=document.createElement("script");d.apiLoadIntitited=!0,e.addEventListener("load",(()=>{d.apiLoaded=!0,t(window.google)})),e.addEventListener("error",(()=>{o("Failed to load the Google 3P Authorization JavaScript Library.")})),e.src=s.library,e.async=!0,e.defer=!0,document.head.appendChild(e)}}else o(s.ssrError)})),p=t=>{d.apiLoadIntitited?d.apiLoaded?t(window.google):q((()=>d.apiLoaded),(o=>{o&&t(window.google)})):y().then((o=>{t(o)}))},S=(t,o,e,n)=>{if(!t.client_id)throw new Error("Prop client id required since plugin is not initialized with a client id");p((()=>{((i,f,u,r,c)=>{if(c){const w=i.callback;i.callback=g=>{g.credential?w&&w(g):c(g)}}window.google.accounts.id.initialize(i);const l=f.value;l&&!r&&window.google.accounts.id.renderButton(l,u)})(t,o,e.buttonConfig,n,e.error),e.prompt&&B({clientId:e.clientId,callback:e.callback,error:e.error,autoLogin:e.autoLogin})}))},O=t=>new Promise(((o,e)=>{p((n=>{if(!(t&&t.clientId||a.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");n.accounts.oauth2.initCodeClient({client_id:t&&t.clientId||a.clientId||"",scope:s.scopes,ux_mode:"popup",callback:i=>{i.code?o(i):e(i)},error_callback:i=>{e(i)}}).requestCode()}))})),x=t=>new Promise(((o,e)=>{p((n=>{if(!(t&&t.clientId||a.clientId))throw new Error("clientId is required since the plugin is not initialized with a Client Id");n.accounts.oauth2.initTokenClient({client_id:t&&t.clientId||a.clientId||"",scope:s.scopes,callback:i=>{i.access_token?o(i):e(i)},error_callback:i=>{e(i)}}).requestAccessToken()}))})),B=t=>{if(!t&&(t={}),!t.clientId&&!a.clientId)throw new Error("clientId is required");const o={use_fedcm_for_prompt:!0};return t.clientId&&(o.client_id=t.clientId),!t.clientId&&a.clientId&&(o.client_id=a.clientId),t.context&&(o.context=t.context),t.autoLogin!=null&&(o.auto_select=t.autoLogin),t.cancelOnTapOutside!=null&&(o.cancel_on_tap_outside=t.cancelOnTapOutside),new Promise(((e,n)=>{o.callback=i=>{t&&t.callback&&t.callback(i),i.credential?e(i):n(i)},p((i=>{i.accounts.id.initialize(o),i.accounts.id.prompt()}))}))},P=()=>{p((t=>{t.accounts.id.disableAutoSelect()}))};var m=C({__name:"GoogleLogin",props:{clientId:{type:String,required:!1},prompt:{type:Boolean,required:!1,default:!1},autoLogin:{type:Boolean,required:!1,default:!1},popupType:{type:String,required:!1},idConfiguration:{type:Object,required:!1},buttonConfig:{type:Object,required:!1},callback:{type:Function,required:!1},error:{type:Function,required:!1}},setup(t){if(!(typeof window<"u"))throw new Error(s.ssrError);const o=!!_().default,e=t,n=((u,r)=>{const c={...u};for(const l in r)r[l]!==void 0&&r[l]!==null&&(c[l]=r[l]);return c})(a,e),i={client_id:n.clientId||null,auto_select:n.autoLogin||!1,callback:n.callback,...n.idConfiguration},f=E();return L((()=>{S(i,f,n,o),e.popupType&&!o&&console.warn("Option 'popupType' is ignored since a slot which act as a custom login button was not found!!!")})),(u,r)=>(h(),I("div",{class:"g-btn-wrapper",onClick:r[0]||(r[0]=c=>b(o)&&void(b(n).popupType==="TOKEN"?x({clientId:n.clientId}).then((l=>{n.callback&&n.callback(l)})).catch((l=>{n.error&&n.error(l)})):O({clientId:n.clientId}).then((l=>{n.callback&&n.callback(l)})).catch((l=>{n.error&&n.error(l)}))))},[b(o)?v("v-if",!0):(h(),I("span",{key:0,ref_key:"buttonRef",ref:f,class:"g-btn"},null,512)),T(u.$slots,"default")]))}});(function(t,o){o===void 0&&(o={});var e=o.insertAt;if(typeof document<"u"){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",e==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}})(`
.g-btn-wrapper[data-v-5e610566] {
  display: inline-block;
}
`),m.__scopeId="data-v-5e610566",m.__file="src/plugin/GoogleLogin.vue";var A={install:(t,o)=>{o&&(e=>{e.clientId&&(a.clientId=e.clientId),e.popupType&&(a.popupType=e.popupType),e.prompt!=null&&(a.prompt=e.prompt),e.autoLogin!=null&&(a.autoLogin=e.autoLogin),e.idConfiguration&&(a.idConfiguration=e.idConfiguration),e.buttonConfig&&(a.buttonConfig=e.buttonConfig),e.callback&&(a.callback=e.callback)})(o),y().then((()=>{if(o.clientId){const e={client_id:o.clientId,auto_select:o.autoLogin===!0,callback:o.callback,use_fedcm_for_prompt:!0,...o.idConfiguration};window.google.accounts.id.initialize(e),o.prompt&&window.google.accounts.id.prompt()}})),t.component("GoogleLogin",m)}};export{A as L,N as b,P as k};
